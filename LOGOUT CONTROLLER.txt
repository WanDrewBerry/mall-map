LOGOUT CONTROLLER

const blocklist = require('../utils/blocklist'); // Import the shared blocklist

const logoutUser = (req, res) => {
  const authHeader = req.header('Authorization');
  if (authHeader && authHeader.startsWith("Bearer ")) {
    const token = authHeader.split(" ")[1];
    blocklist.add(token); // Add the access token to the shared blocklist
    console.log("ðŸš« Token invalidated and added to blocklist:", token);
  }

  // Clear the refresh token cookie
  res.clearCookie('refreshToken', {
    httpOnly: true,
    secure: true, // Use true in production
    sameSite: 'strict',
  });

  console.log("âœ… Access token added to blocklist. User logged out.");
  res.status(200).json({ status: false, message: "Logged out successfully." });
};

module.exports = { logoutUser };